

subroutine FFT(A,B,n)

implicit none

integer, parameter :: nmax=512

complex, dimension(nmax) :: A,B

integer :: n,i,k

if (n==1) then

B(0)=A(0)

else

do k=0,n/2-1

B(k)=A(k)+A(n/2+k)

B(n/2+k)=A(k)-A(n/2+k)

end do

call FFT(B(0:n/2-1),C,n/2)

call FFT(B(n/2:n-1),D,n/2)

do k=0,n/2-1

B(k)=C(k)+exp(-2*pi*k*i/n)*D(k)

B(n/2+k)=C(k)-exp(-2*pi*k*i/n)*D(k)

end do

end if

return

end subroutine FFT
